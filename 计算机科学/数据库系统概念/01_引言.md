# 1 引言

数据库管理系统(DBMS)：由`一个相互关联的数据的集合`和`一组用以访问这些数据的程序`组成。

## 1.3 数据视图

数据库系统的一个主要目的是给用户提供数据的抽象视图。

### 数据抽象

三个层次上进行抽象：

- 物理层：描述数据实际上是怎样存储的
- 逻辑层：描述数据库中存储什么数据以及这些数据间是什么关系。数据库管理员主要使用这一层
- 视图层：用户使用到的界面

### 模式和实例

- 模式(schema)：数据库的总体设计
- 实例(instance)：特定时刻存储在数据库中的信息的集合

### 数据模型

数据模型（data model）是一个描述数据、数据联系、数据语义以及一致性约束的概念工具的集合。可以分成四类：

- 关系模型（relational model）：用表来表示数据和数据之间的联系。关系模型在视图层和逻辑层描述数据，使用户不必关注数据存储的底层细节。
- 实体-联系模型（entity—relationship model）：现实世界由一组称作实体的对象以及这些对象间的联系构成。这是比关系模型更高层的数据模型，被广泛用于数据库设计。
- 基于对象的数据模型（object-based data model）：借鉴了编程中的OOP。可以看做是E-R模型增加了封装、方法和对象标识等概念后的拓展。
- 半结构化数据模型（semistructured data model）：允许相同类型的数据项含有不同的属性集。

## 1.4 数据库语言

### 数据操作语言 DML, Data-Manipulation Language

有两类DML：

- 过程化DML(procedural DML)：要求用户指定需要什么数据，以及如何获取这些数据
- 声明式DML(declarative DML)：即非过程化的，要求用户指定需要什么数据，而不指明如何获取这些数据

声明式DML更简单易学，但是要求数据库系统自己必须找出一种访问数据的高效途径。

### 数据定义语言 DDL, Data-Defining Language

存储在数据库汇总的数据值必须满足一些一致性约束（consistency constraint）

- 域约束（domain constraint）
  每个属性都必须对应于一个所有可能取值构成的域。
- 参照完整性（referential integrity）
  一个关系中给定属性集上的取值必须也在另一关系的某一属性集的取值中出现。如一个course记录中的dept_name属性值必须出现在department关系中的某个记录的dept_name属性中。
- 断言（assertion）
  一个断言就是数据库需要时刻满足的某一条件。域约束和参照完整性约束是断言的特殊形式。
- 授权（authorization）
  即用户的访问权限，包括读、插入、更新和删除。

## 1.5 关系数据库

关系数据库基于关系模型，使用一系列表来表达数据以及这些数据之间的关系。

关系模型是一种基于记录的模型。每个表包含一种特定类型的记录。每种记录类型定义固定类型的字段。

SQL查询语言是非过程化的，即声明式的。

## 1.6 数据库设计

### 设计过程

1. 指定用户需求文档
2. 概念设计（conceptual-design）：选择一个数据模型，并运用改选定的数据模型的概念，将需求转变为数据库的概念模式。从关系模型的角度看，概念设计阶段涉及决定数据库中应该包括哪些属性，以及如何将这些属性组织到多个表中。前者属于商业决策，后者有两种方法：一是使用实体-联系模型，二是用规范化。
3. 逻辑设计（logical-design）：将高层的概念模式映射到要使用的数据库的实现数据模型上
4. 物理设计（physical-design）：指定数据库的物理特性，包括文件的组织形式及内部的存储结构。

数据库设计要避免两个主要可能的缺陷：

- 冗余
- 不完整

### 实体-联系模型

数据库中的实体通过属性（attribute）集合来描述。联系（relationship）是几个实体间的关联。

除了实体和联系之外，E-R模型还描绘了数据库必须遵守的对其内容的某些约束。一个重要的约束是映射基数（mapping cardinality），它表示通过某个联系集能与一实体进行关联的实体数目。

## 1.7 数据库的存储和查询

数据库的功能部件大致分为两部分：

- 存储管理器
- 查询处理部件

### 存储管理器

存储管理器负责与文件管理器进行交互。原始数据通过操作系统提供的文件系统存储在磁盘上。存储管理器将各种DML语句翻译为底层文件的系统命令。

存储管理部件包括：

- 权限及完整性管理器（authorization and integrity manager）：检测是否满足完整性约束，并检查试图访问数据库的用户的权限。
- 事务管理器（transaction manager）：保证即使发生错误，数据库也保持在一致的状态。并保证事事物的执行不发生冲突。
- 文件管理器（file manager）：管理磁盘存储空间的分配。
- 缓冲区管理器（buffer manager）：负责将数据从磁盘上取到内存中，并决定哪些数据应被放到缓存中。
- 数据文件（data files）：存储数据库自身
- 数据字典（data dictionary）：存储关于数据库结构的元数据，尤其是数据库模式。
- 索引（index）：提供对数据项的快速访问。数据库索引几提供了指向包含特定值的数据的指针。

### 查询处理器

包括：

- DDL解释器（DDL interpreter）：解释DDL，并将这些定义记录在数据字典中
- DML编译器（DML compiler）：将查询语言中的DML翻译为一个高效的执行方案，这包括一些列查询执行引擎能理解的低级指令。
- 查询执行引擎（query evaluation engine）：执行有DML产生的低级指令。

## 1.8 事务管理

事务（transaction）：是数据库应用中完成单一逻辑功能的操作集合。事务具有原子性、一致性和持久性的特点。

事务管理器包括：

- 恢复管理器：如果事物试行过程中发生故障，则把数据恢复到事务开始执行之前的状态。
- 并发控制管理器：在多个事务同时执行的情况下，控制并发事务间的相互影响，保证数据库的一致性。

## 1.10 数据挖掘与信息检索

- 数据挖掘（data mining）：半自动的分析大型数据库并从中找出有用的模式。与机器学习和统计学不同之处在于，它处理大量的主要存储在磁盘上的数据。
- 信息检索（information retrieval）：查询非结构化的文本数据。
